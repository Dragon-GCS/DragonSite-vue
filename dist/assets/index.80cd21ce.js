import{r as h,z as R,m as O,s as P,o as l,M as f,O as u,c as x,a8 as I,a as y,S as w,K as b,u as g,Q as _,a5 as F,Y as N,ag as B}from"./@vue.fb846be3.js";import{E as D,a as M,b as U,c as H,d as L,e as V,f as j,g as z}from"./element-plus.a0c6cafa.js";import{u as A,c as T,a as W}from"./vue-router.0e56c6e7.js";import{a as m}from"./axios.5bc38a7d.js";import{l as K}from"./qs.3fd877a9.js";import"./@vueuse.048c5a89.js";import"./lodash-es.dd08ea16.js";import"./async-validator.fb49d0f5.js";import"./@element-plus.2111aa6d.js";import"./@popperjs.36402333.js";import"./@ctrl.82a509e0.js";import"./side-channel.70f74c3b.js";import"./get-intrinsic.89e72507.js";import"./has-symbols.caae0f97.js";import"./function-bind.cb3858f2.js";import"./has.c1051c46.js";import"./call-bind.b701f999.js";import"./object-inspect.186a03c9.js";const Q=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))n(t);new MutationObserver(t=>{for(const r of t)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function e(t){const r={};return t.integrity&&(r.integrity=t.integrity),t.referrerpolicy&&(r.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?r.credentials="include":t.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(t){if(t.ep)return;t.ep=!0;const r=e(t);fetch(t.href,r)}};Q();const c=a=>`https://api.iconify.design/${a}?color=currentColor`,Y=[{name:"\u516C\u5171\u7F51\u76D8",logRequire:"false",icon:c("fxemoji:harddisk.svg")},{name:"\u4E2A\u4EBA\u7F51\u76D8",logRequire:"true",icon:c("arcticons:password.svg")}],G=[{name:"\u5168\u90E8",icon:c("flat-color-icons:database.svg"),type:""},{name:"\u56FE\u7247",icon:c("vscode-icons:file-type-image.svg"),type:"image"},{name:"\u89C6\u9891",icon:c("vscode-icons:file-type-video.svg"),type:"video"},{name:"\u97F3\u9891",icon:c("vscode-icons:file-type-audio.svg"),type:"audio"},{name:"\u6587\u6863",icon:c("emojione-v1:document-with-text.svg"),type:"document"},{name:"\u6587\u672C",icon:c("vscode-icons:file-type-text.svg"),type:"text"},{name:"\u5176\u4ED6",icon:c("flat-color-icons:answers.svg"),type:"other"}],C="DragonSite",E=h(localStorage.getItem("username")||"");h(localStorage.getItem("token")||"");h(localStorage.getItem("expired_time")||"");const k=h(E.value!==""),Re=["image","video","audio"],Ie=h([]);const J=["src"],X=["src"],Z=R({__name:"SideMenu",setup(a){let o=h(document.body.clientWidth<768);return O(()=>{window.onresize=()=>{o.value=document.body.clientWidth<768}}),P(()=>{window.onresize=null}),(e,n)=>{const t=D,r=M,s=U;return l(),f(s,{collapse:g(o),"unique-opened":!0,router:!0,"default-active":"0-0"},{default:u(()=>[(l(!0),x(b,null,I(g(Y),(i,p)=>(l(),f(r,{index:`${p}`},{title:u(()=>[y("img",{width:"20",src:i.icon},null,8,J),y("span",null,w(i.name),1)]),default:u(()=>[(l(!0),x(b,null,I(g(G),(d,q)=>(l(),f(t,{index:`${p}-${q}`,route:{name:"main",query:{path:"/",logRequire:i.logRequire,filter:d.type}}},{default:u(()=>[y("img",{src:d.icon},null,8,X),y("span",null,w(d.name),1)]),_:2},1032,["index","route"]))),256))]),_:2},1032,["index"]))),256))]),_:1},8,["collapse"])}}}),v=()=>({token:localStorage.getItem("token")||"",username:localStorage.getItem("username")||"",expired_time:localStorage.getItem("expired_time")||0}),Le=async(a,o,e)=>m.get("/api/disk",{params:{path:a,login_require:o,category:e},headers:v()}).then(n=>n,n=>(console.log("err",n),n)),Ce=async(a,o,e,n)=>m.delete("/api/disk",{params:{path:a,login_require:n,name:o,is_dir:e},headers:v()}).then(t=>t).catch(t=>t),$e=async(a,o,e)=>m.post("/api/disk",{},{params:{path:a,name:o,login_require:e},headers:v()}).then(n=>n.data),Ae=(a,o,e=!1)=>m.get("/api/disk/download",{params:{path:o,preview:!1,login_require:e},headers:v()}).then(n=>{var t=document.createElement("a");t.href=URL.createObjectURL(new Blob([n.data])),t.style.display="none",t.setAttribute("download",a),document.body.appendChild(t),t.click(),URL.revokeObjectURL(t.href)}),qe=(a,o=!1)=>m.get("/api/disk/download",{params:{path:a,preview:!0,login_require:o},headers:v(),responseType:"blob"}).then(e=>e.data),Oe=(a,o,e,n)=>m.patch("/api/disk",{},{params:{path:a,target:o,is_dir:e,login_require:n},headers:v()}).then(t=>t.data),Pe=(a,o)=>{const e=new URLSearchParams;return e.append("username",a),e.append("password",o),m.post("/api/auth/login",e).then(n=>{if(n.status===200)return localStorage.setItem("token",n.data.token),localStorage.setItem("username",n.data.username),localStorage.setItem("expired_time",n.data.expired_time),k.value=!0,E.value=n.data.username,!0})},ee=()=>{localStorage.removeItem("token"),localStorage.removeItem("username"),localStorage.removeItem("expired_time"),k.value=!1,E.value=""},te=F("\u767B\u5F55"),ne=R({__name:"Header",props:{siteName:String},emits:["pointerenter","pointerleave"],setup(a){const o=A(),e=()=>o.push({path:"/login"}),n=()=>o.push({path:"/"}),t=()=>{ee(),o.push({path:"/"})};return(r,s)=>{const i=H;return l(),x(b,null,[_(i,{onClick:n,link:!0},{default:u(()=>[y("h1",null,w(a.siteName),1)]),_:1}),g(k)?(l(),x("h1",{key:1,onClick:t,style:{cursor:"pointer"}},"Welcome "+w(g(E)),1)):(l(),f(i,{key:0,onClick:e,"auto-insert-space":""},{default:u(()=>[te]),_:1}))],64)}}});const oe=R({__name:"App",setup(a){document.title=C;const o=A();return m.defaults.paramsSerializer=e=>K.stringify(e,{indices:!1}),m.interceptors.response.use(e=>(console.log("response",e),e),e=>(e.response.status===401&&(L.info(e.response.data.detail),k.value=!1,o.push({name:"login",query:{redirect:o.currentRoute.value.fullPath}})),e.response.status===400&&(L.info(e.response.data.detail),k.value=!1),e.response.status===422&&console.log(e.response.data.detail),e)),(e,n)=>{const t=ne,r=V,s=Z,i=N("router-view"),p=j,d=z;return l(),f(d,null,{default:u(()=>[_(r,null,{default:u(()=>[_(t,{"site-name":g(C)},null,8,["site-name"])]),_:1}),_(d,null,{default:u(()=>[_(s),_(p,null,{default:u(()=>[(l(),f(i,{key:e.$route.fullPath}))]),_:1})]),_:1})]),_:1})}}}),ae="modulepreload",$={},re="/",S=function(o,e){return!e||e.length===0?o():Promise.all(e.map(n=>{if(n=`${re}${n}`,n in $)return;$[n]=!0;const t=n.endsWith(".css"),r=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${n}"]${r}`))return;const s=document.createElement("link");if(s.rel=t?"stylesheet":ae,t||(s.as="script",s.crossOrigin=""),s.href=n,document.head.appendChild(s),t)return new Promise((i,p)=>{s.addEventListener("load",i),s.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${n}`)))})})).then(()=>o())},se=[{path:"/",redirect:{name:"main",query:{path:"/",logRequire:"false"}}},{path:"/home",name:"main",component:()=>S(()=>import("./MainView.312584db.js"),["assets/MainView.312584db.js","assets/MainView.a8c7d486.css","assets/element-plus.a0c6cafa.js","assets/element-plus.dd0e05f1.css","assets/@vue.fb846be3.js","assets/@vueuse.048c5a89.js","assets/lodash-es.dd08ea16.js","assets/async-validator.fb49d0f5.js","assets/@element-plus.2111aa6d.js","assets/@popperjs.36402333.js","assets/@ctrl.82a509e0.js","assets/vue-router.0e56c6e7.js","assets/axios.5bc38a7d.js","assets/qs.3fd877a9.js","assets/side-channel.70f74c3b.js","assets/get-intrinsic.89e72507.js","assets/has-symbols.caae0f97.js","assets/function-bind.cb3858f2.js","assets/has.c1051c46.js","assets/call-bind.b701f999.js","assets/object-inspect.186a03c9.js"])},{path:"/login",name:"login",component:()=>S(()=>import("./Login.08c7c45a.js"),["assets/Login.08c7c45a.js","assets/Login.48399566.css","assets/element-plus.a0c6cafa.js","assets/element-plus.dd0e05f1.css","assets/@vue.fb846be3.js","assets/@vueuse.048c5a89.js","assets/lodash-es.dd08ea16.js","assets/async-validator.fb49d0f5.js","assets/@element-plus.2111aa6d.js","assets/@popperjs.36402333.js","assets/@ctrl.82a509e0.js","assets/vue-router.0e56c6e7.js","assets/axios.5bc38a7d.js","assets/qs.3fd877a9.js","assets/side-channel.70f74c3b.js","assets/get-intrinsic.89e72507.js","assets/has-symbols.caae0f97.js","assets/function-bind.cb3858f2.js","assets/has.c1051c46.js","assets/call-bind.b701f999.js","assets/object-inspect.186a03c9.js"])},{path:"/preview",name:"preview",component:()=>S(()=>import("./Preview.0aff5800.js"),["assets/Preview.0aff5800.js","assets/Preview.49472dc0.css","assets/element-plus.a0c6cafa.js","assets/element-plus.dd0e05f1.css","assets/@vue.fb846be3.js","assets/@vueuse.048c5a89.js","assets/lodash-es.dd08ea16.js","assets/async-validator.fb49d0f5.js","assets/@element-plus.2111aa6d.js","assets/@popperjs.36402333.js","assets/@ctrl.82a509e0.js","assets/vue-router.0e56c6e7.js","assets/axios.5bc38a7d.js","assets/qs.3fd877a9.js","assets/side-channel.70f74c3b.js","assets/get-intrinsic.89e72507.js","assets/has-symbols.caae0f97.js","assets/function-bind.cb3858f2.js","assets/has.c1051c46.js","assets/call-bind.b701f999.js","assets/object-inspect.186a03c9.js"])}],ie=T({history:W(),routes:se});B(oe).use(ie).mount("#app");export{Re as a,Oe as b,$e as c,Ae as d,Pe as e,v as g,Ie as i,Le as l,qe as p,Ce as r};
